<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Multiâ€‘DB Product Admin</title>
  <style>
    body { font-family: sans-serif; padding: 1rem; }
    label { display: block; margin: .5rem 0 .2rem; }
    input, select, button { padding: .4rem; margin-bottom: .6rem; width: 100%; max-width: 400px; }
    #formContainer { margin-top: 1rem; }
  </style>
  <script src="user.js"></script>
  <script>
  (() => {
    async function guardAdminPanel() {
      try {
        if (typeof window.checkSession === 'function') {
          await window.checkSession();
        }

        const user = (typeof window.getCurrentUser === 'function')
          ? window.getCurrentUser()
          : null;

        const role = user?.user_role || user?.role;
        const isAdmin = role === 'admin' || role === 'super_admin';

        if (!isAdmin) {
        showToast('Access denied. Please sign in with an admin account.', { type: 'error' });
          window.location.href = 'index.html';
        }
      } catch (e) {
        console.error('Admin check failed:', e);
        window.location.href = 'index.html';
      }
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', guardAdminPanel, { once: true });
    } else {
      guardAdminPanel();
    }
  })();
</script>
</head>
<body>
  <h1>Product Administration (Customer: exampleCustomer)</h1>

  <label for="productSelect">Select Product:</label>
  <select id="productSelect"></select>
  <button id="addProductBtn" type="button">Add Product</button>
  <div id="formContainer"></div>

  <script src="user_admin_panel.js"></script>
</body>
</html>
